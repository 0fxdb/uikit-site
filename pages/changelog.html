<div class="uk-section uk-section-primary uk-preserve-color" uk-height-viewport="mode: expand">

    <div class="uk-container uk-container-small">

        <div class="uk-card uk-card-default uk-card-body">

            <h1 class="uk-margin-medium uk-text-center">Changelog</h1>

            <div id="js-changelog"></div>

        </div>

    </div>

</div>

<script type="text/javascript">

    $(function () {

        $.get('assets/uikit/CHANGELOG.md', {nc: Math.random()}, function (body) {
            $('#js-changelog').html(parse(body));
        });

        function parse(markdown) {

            var renderer = new marked.Renderer(), section;

            renderer.list = text => '<ul class="uk-list">' + text + '</ul>';

            renderer.listitem = function (text) {

                var label = '';

                switch (section) {

                    case 'Added':
                        label = 'uk-label-success';
                        break;

                    case 'Removed':
                    case 'Deprecated':
                        label = 'uk-label-warning';
                        break;

                    case 'Fixed':
                    case 'Security':
                        label = 'uk-label-danger';
                }

                return '<li><span class="uk-label ' + label + ' uk-margin-right uk-text-center uk-width-small tm-width-small">' + section + '</span> ' + text + '</li>';
            };

            renderer.heading = function (text, level) {

                text = text.replace(/(\(.*?\))/, '<span class="uk-text-muted">$1</span>');

                if (level == 2) {
                    return '<h' + level + ' class="uk-h3">' + text + '</h' + level + '>';
                }

                if (level == 3) {
                    section = text;
                }

                return '';
            };

            return marked(markdown, {renderer: renderer});
        }
    });

</script>
